name: Mark stale issues and pull requests

on:
  schedule:
    # æ¯å¤©UTCæ—¶é—´15:40è¿è¡Œï¼ˆå¯æ ¹æ®ä½ çš„æ—¶åŒºè°ƒæ•´ï¼‰
    - cron: '40 15 * * *'
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  stale:
    runs-on: ubuntu-latest
    permissions:
      issues: write
      pull-requests: write

    steps:
    - uses: actions/stale@v9
      with:
        repo-token: ${{ secrets.GITHUB_TOKEN }}
        
        # é€šç”¨é…ç½®
        days-before-stale: 60       # 60å¤©æ— æ´»åŠ¨æ ‡è®°ä¸ºstale
        days-before-close: 14       # æ ‡è®°å14å¤©æ— æ´»åŠ¨åˆ™å…³é—­
        remove-stale-when-updated: true  # å½“æœ‰æ–°æ´»åŠ¨æ—¶è‡ªåŠ¨ç§»é™¤staleæ ‡è®°
        exempt-issue-labels: "pinned,confirmed,bug"  # è¿™äº›æ ‡ç­¾çš„issueä¸å¤„ç†
        
        # Issueç›¸å…³é…ç½®
        stale-issue-label: "status/stale"
        stale-issue-message: |
          â° This issue has been inactive for over 60 days. If it still needs to be addressed, please leave a message to inform of the latest progress.
          If there is no response within 7 days, we will automatically close this issue.
          
          *Automated reminder from the kronos-orm maintenance team*
          ------
          â° è¯¥issueå·²è¶…è¿‡60å¤©æ— æ´»åŠ¨ã€‚å¦‚æœä»ç„¶éœ€è¦å¤„ç†ï¼Œè¯·ç•™è¨€å‘ŠçŸ¥æœ€æ–°è¿›å±•ã€‚
          å¦‚æœ7å¤©å†…æ²¡æœ‰æ”¶åˆ°å›å¤ï¼Œæˆ‘ä»¬å°†è‡ªåŠ¨å…³é—­è¯¥issueã€‚
          
          *æ¥è‡ªkronos-ormç»´æŠ¤å›¢é˜Ÿçš„è‡ªåŠ¨åŒ–æé†’*
        close-issue-message: |
          ğŸš¨ Due to no new activity for over 14 days, this issue has been automatically closed. To reopen it, please:
          1. Leave a message explaining the latest progress
          2. Manually reopen it through the issue list
          
          Thank you for your contribution to the kronos-orm project!
          ------
          ğŸš¨ ç”±äºè¶…è¿‡14å¤©æ— æ–°æ´»åŠ¨ï¼Œè¯¥issueå·²è¢«è‡ªåŠ¨å…³é—­ã€‚å¦‚éœ€é‡æ–°æ‰“å¼€ï¼Œè¯·ï¼š
          1. ç•™è¨€è¯´æ˜æœ€æ–°è¿›å±•
          2. é€šè¿‡issueåˆ—è¡¨æ‰‹åŠ¨é‡æ–°æ‰“å¼€
          
          æ„Ÿè°¢ä½ å¯¹kronos-ormé¡¹ç›®çš„è´¡çŒ®ï¼
        close-issue-label: "closed/stale"  # å…³é—­æ—¶æ·»åŠ çš„æ ‡ç­¾
        
        # PRç›¸å…³é…ç½®
        stale-pr-label: "status/stale"
        stale-pr-message: |
          â³ This PR has exceeded 60 days without updates. Please check if it is still necessary to merge:
          - If it is still necessary to merge, please update the code or leave a message for confirmation
          - If it is no longer needed, please proactively close it
          
          No response after 7 days will be automatically closed.
          ------
          â³ è¯¥PRå·²è¶…è¿‡60å¤©æ— æ›´æ–°ã€‚è¯·æ£€æŸ¥æ˜¯å¦ä»éœ€åˆå¹¶ï¼š
          - å¦‚æœä»éœ€åˆå¹¶ï¼Œè¯·æ›´æ–°ä»£ç æˆ–ç•™è¨€ç¡®è®¤
          - å¦‚æœå·²ä¸éœ€è¦ï¼Œè¯·ä¸»åŠ¨å…³é—­
          
          7å¤©åæ— å“åº”å°†è‡ªåŠ¨å…³é—­ã€‚
        days-before-pr-stale: 60    # PRå•ç‹¬é…ç½®å¤©æ•°ï¼ˆå¦‚æœä¸åŒï¼‰
        days-before-pr-close: 7
        exempt-pr-labels: "dependencies,priority"
        close-pr-message: |
          ğŸ”’ Due to long-term inactivity with no updates, this PR has been automatically closed. You can:
          1. Update the branch and resubmit
          2. Use the /reopen command to reopen
          
          The kronos-orm project thanks you for your contribution!
          ------
          ğŸ”’ ç”±äºé•¿æœŸæ— æ›´æ–°ï¼Œè¯¥PRå·²è¢«è‡ªåŠ¨å…³é—­ã€‚ä½ å¯ä»¥ï¼š
          1. é€šè¿‡åˆ†æ”¯æ›´æ–°åé‡æ–°æäº¤
          2. ä½¿ç”¨/reopenå‘½ä»¤é‡æ–°æ‰“å¼€
          
          kronos-ormé¡¹ç›®æ„Ÿè°¢ä½ çš„è´¡çŒ®ï¼
        close-pr-label: "closed/stale-pr"
        
        # å¯è§†åŒ–ç»Ÿè®¡
        log-level: debug    # è°ƒè¯•æ—¶æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
        operations-per-run: 100  # å•æ¬¡è¿è¡Œå¤„ç†çš„æœ€å¤§æ•°é‡
