# 3. 构建集成与插件参数

本节说明如何在 Gradle/Maven 中启用 kronos-compiler-plugin，以及如何配置其命令行参数。

## 3.1 Gradle（Kotlin DSL）

前提：Kotlin 1.9+ 且 K2 编译器已启用（K2 是默认或通过选项开启）。

示例：

```kotlin
plugins {
    kotlin("jvm") version "<your-kotlin-version>"
}

dependencies {
    // 编译器插件以 "compileOnly" 或 "kotlinCompilerPluginClasspath" 的方式引入
    compileOnly("io.github.kotlin-orm:kronos-compiler-plugin:<version>")
}

kotlin {
    compilerOptions {
        freeCompilerArgs.addAll(
            "-Xplugin=kronos-compiler-plugin",
            "-P",
            "plugin:kronos-compiler-plugin:debug=true",
            "-P",
            "plugin:kronos-compiler-plugin:debug-info-path=build/tmp/kronosIrDebug"
        )
    }
}
```

说明：
- 插件 ID 为 `kronos-compiler-plugin`；
- `debug`（可选）：开启后会在编译末尾把 IR 文本写入 `debug-info-path` 指向的目录；
- `debug-info-path`（可选）：IR dump 输出路径，默认 `build/tmp/kronosIrDebug`。

注意：不同 Kotlin 版本/Gradle 版本，对编译器插件装配方式可能略有差异；也可使用官方的 `kotlinCompilerPluginClasspath` 配置将 jar 放入编译器类路径。

## 3.2 Maven

示例：

```xml
<plugin>
  <groupId>org.jetbrains.kotlin</groupId>
  <artifactId>kotlin-maven-plugin</artifactId>
  <version>${kotlin.version}</version>
  <configuration>
    <args>
      <arg>-Xplugin=kronos-compiler-plugin</arg>
      <arg>-P</arg>
      <arg>plugin:kronos-compiler-plugin:debug=true</arg>
      <arg>-P</arg>
      <arg>plugin:kronos-compiler-plugin:debug-info-path=build/tmp/kronosIrDebug</arg>
    </args>
  </configuration>
  <dependencies>
    <dependency>
      <groupId>io.github.kotlin-orm</groupId>
      <artifactId>kronos-compiler-plugin</artifactId>
      <version>${kronos.compiler.version}</version>
    </dependency>
  </dependencies>
</plugin>
```

## 3.3 命令行参数清单

- `debug`（Boolean，默认 false）：是否启用 IR dump；
- `debug-info-path`（String，默认 `build/tmp/kronosIrDebug`）：IR dump 输出目录。
