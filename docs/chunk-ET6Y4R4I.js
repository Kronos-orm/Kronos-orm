import{a as j}from"./chunk-FJ26F7HW.js";import{a as h}from"./chunk-4FO7WJ36.js";import{a as l}from"./chunk-LVHT47OW.js";import{F as u}from"./chunk-LWH7SIW3.js";import{Pb as o,jc as r,kc as i,ra as g,xb as c}from"./chunk-TLBD5JYT.js";import{a as p,b as d,g as m}from"./chunk-ODN5LVDJ.js";var y=m(u());var E={title:"Update or Insert Records",mdFile:"./index.md",category:j,order:5},n=E;var t=[];var T={},k=T;var S=`<h1 id="update-or-insert-records" class="ngde">Update or Insert Records<a title="Link to heading" class="ng-doc-header-link ngde" href="/en/database/upsert-records#update-or-insert-records"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h1><p class="ngde">\u5728Kronos\u4E2D\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528<code class="ngde">KPojo.upsert().execute()</code>\u65B9\u6CD5\u7528\u4E8E\u5411\u6570\u636E\u5E93\u4E2D\u63D2\u5165\u6216\u66F4\u65B0\u8BB0\u5F55\u3002</p><p class="ngde">\u7531\u4E8E\u5404\u4E2A\u6570\u636E\u5E93\u7684\u5B9E\u73B0\u4E0D\u540C\uFF0C\u56E0\u6B64\u5728Kronos\u4E2D\uFF0C\u6211\u4EEC\u5BF9<code class="ngde">upsert</code>\u64CD\u4F5C\u8FDB\u884C\u4E86\u7EDF\u4E00\u7684\u5C01\u88C5\uFF0C\u4EE5\u5B9E\u73B0\u8DE8\u6570\u636E\u5E93\u7684\u517C\u5BB9\u6027\u3002</p><h2 id="\u4F7F\u7528on\u8BBE\u7F6E\u552F\u4E00\u6027\u7EA6\u675F\u5B57\u6BB5" class="ngde">\u4F7F\u7528<span style="color: #DD6666" class="ngde">on</span>\u8BBE\u7F6E\u552F\u4E00\u6027\u7EA6\u675F\u5B57\u6BB5<a title="Link to heading" class="ng-doc-header-link ngde" href="/en/database/upsert-records#\u4F7F\u7528on\u8BBE\u7F6E\u552F\u4E00\u6027\u7EA6\u675F\u5B57\u6BB5"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde"><code class="ngde">on</code>\u65B9\u6CD5\u7528\u4E8E\u552F\u4E00\u6027\u8BBE\u7F6E\u7EA6\u675F\u5B57\u6BB5\uFF0C\u53EF\u4EE5\u662F\u5355\u4E2A\u5B57\u6BB5\uFF0C\u4E5F\u53EF\u4EE5\u662F\u591A\u4E2A\u5B57\u6BB5\u3002\u5F53\u8BB0\u5F55\u5B58\u5728\u65F6\uFF0CKronos\u4F1A\u6839\u636E<code class="ngde">on</code>\u65B9\u6CD5\u8BBE\u7F6E\u7684\u5B57\u6BB5\u751F\u6210\u66F4\u65B0\u6761\u4EF6\u8BED\u53E5\uFF0C\u5426\u5219\u751F\u6210\u63D2\u5165\u8BED\u53E5\u3002</p><ng-doc-tab group="Case 1" name="kotlin" icon="kotlin" class="ngde"><pre class="ngde hljs"><code class="hljs language-kotlin code-lines ngde" lang="kotlin" name="" icon="" highlightedlines="[7,8,9,10,11]"><span class="line ngde"><span class="hljs-keyword ngde">val</span> user: User = User(
</span><span class="line ngde">        id = <span class="hljs-number ngde">1</span>,
</span><span class="line ngde">        name = <span class="hljs-string ngde">"Kronos"</span>,
</span><span class="line ngde">        age = <span class="hljs-number ngde">18</span>
</span><span class="line ngde">    )
</span><span class="line ngde">
</span><span class="line highlighted ngde">user
</span><span class="line highlighted ngde">  .upsert()
</span><span class="line highlighted ngde">  .on { it.id + it.name }
</span><span class="line highlighted ngde">  .execute()
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 1" name="Mysql" icon="mysql" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> \`<span class="hljs-keyword ngde">user</span>\` <span class="hljs-keyword ngde">WHERE</span> \`id\` <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> \`name\` <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> \`<span class="hljs-keyword ngde">user</span>\` <span class="hljs-keyword ngde">SET</span> \`id\` <span class="hljs-operator ngde">=</span> :id, \`name\` <span class="hljs-operator ngde">=</span> :name, \`age\` <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> \`id\` <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> \`name\` <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> \`<span class="hljs-keyword ngde">user</span>\` (\`id\`, \`name\`, \`age\`) <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 1" name="PostgreSQL" icon="postgres" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> "user" <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> "name" <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> "user" <span class="hljs-keyword ngde">SET</span> "id" <span class="hljs-operator ngde">=</span> :id, "name" <span class="hljs-operator ngde">=</span> :name, "age" <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> "name" <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> "user" ("id", "name", "age") <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 1" name="SQLite" icon="sqlite" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> "user" <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> "name" <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> "user" <span class="hljs-keyword ngde">SET</span> "id" <span class="hljs-operator ngde">=</span> :id, "name" <span class="hljs-operator ngde">=</span> :name, "age" <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> "name" <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> "user" ("id", "name", "age") <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 1" name="SQLServer" icon="sqlserver" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> [<span class="hljs-keyword ngde">user</span>] <span class="hljs-keyword ngde">WHERE</span> [id] <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> [name] <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> [<span class="hljs-keyword ngde">user</span>] <span class="hljs-keyword ngde">SET</span> [id] <span class="hljs-operator ngde">=</span> :id, [name] <span class="hljs-operator ngde">=</span> :name, [age] <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> [id] <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> [name] <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> [<span class="hljs-keyword ngde">user</span>] ([id], [name], [age]) <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 1" name="Oracle" icon="oracle" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> "user" <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> "name" <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> "user" <span class="hljs-keyword ngde">SET</span> "id" <span class="hljs-operator ngde">=</span> :id, "name" <span class="hljs-operator ngde">=</span> :name, "age" <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> "name" <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> "user" ("id", "name", "age") <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><h2 id="\u4F7F\u7528upsert\u8BBE\u7F6E\u66F4\u65B0\u5B57\u6BB5" class="ngde">\u4F7F\u7528<span style="color: #DD6666" class="ngde">upsert</span>\u8BBE\u7F6E\u66F4\u65B0\u5B57\u6BB5<a title="Link to heading" class="ng-doc-header-link ngde" href="/en/database/upsert-records#\u4F7F\u7528upsert\u8BBE\u7F6E\u66F4\u65B0\u5B57\u6BB5"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde">\u7528\u4E8E\u6307\u5B9A\u5F53\u8BB0\u5F55\u5B58\u5728\u65F6\u9700\u8981\u66F4\u65B0\u7684\u5B57\u6BB5\u3002</p><ng-doc-tab group="Case 2" name="kotlin" icon="kotlin" class="ngde"><pre class="ngde hljs"><code class="hljs language-kotlin code-lines ngde" lang="kotlin" name="" icon="" highlightedlines="[7,8,9,10,11]"><span class="line ngde"><span class="hljs-keyword ngde">val</span> user: User = User(
</span><span class="line ngde">        id = <span class="hljs-number ngde">1</span>,
</span><span class="line ngde">        name = <span class="hljs-string ngde">"Kronos"</span>,
</span><span class="line ngde">        age = <span class="hljs-number ngde">18</span>
</span><span class="line ngde">    )
</span><span class="line ngde">
</span><span class="line highlighted ngde">user
</span><span class="line highlighted ngde">  .upsert { it.name }
</span><span class="line highlighted ngde">  .on { it.id }
</span><span class="line highlighted ngde">  .execute()
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 2" name="Mysql" icon="mysql" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> \`<span class="hljs-keyword ngde">user</span>\` <span class="hljs-keyword ngde">WHERE</span> \`id\` <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> \`<span class="hljs-keyword ngde">user</span>\` <span class="hljs-keyword ngde">SET</span> \`name\` <span class="hljs-operator ngde">=</span> :name <span class="hljs-keyword ngde">WHERE</span> \`id\` <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> \`<span class="hljs-keyword ngde">user</span>\` (\`id\`, \`name\`, \`age\`) <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 2" name="PostgreSQL" icon="postgres" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> "user" <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> "user" <span class="hljs-keyword ngde">SET</span> "name" <span class="hljs-operator ngde">=</span> :name <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> "user" ("id", "name", "age") <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 2" name="SQLite" icon="sqlite" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> \`<span class="hljs-keyword ngde">user</span>\` <span class="hljs-keyword ngde">WHERE</span> \`id\` <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> \`<span class="hljs-keyword ngde">user</span>\` <span class="hljs-keyword ngde">SET</span> \`name\` <span class="hljs-operator ngde">=</span> :name <span class="hljs-keyword ngde">WHERE</span> \`id\` <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> \`<span class="hljs-keyword ngde">user</span>\` (\`id\`, \`name\`, \`age\`) <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 2" name="SQLServer" icon="sqlserver" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> [<span class="hljs-keyword ngde">user</span>] <span class="hljs-keyword ngde">WHERE</span> [id] <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> [<span class="hljs-keyword ngde">user</span>] <span class="hljs-keyword ngde">SET</span> [name] <span class="hljs-operator ngde">=</span> :name <span class="hljs-keyword ngde">WHERE</span> [id] <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> [<span class="hljs-keyword ngde">user</span>] ([id], [name], [age]) <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 2" name="Oracle" icon="oracle" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> "user" <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> "user" <span class="hljs-keyword ngde">SET</span> "name" <span class="hljs-operator ngde">=</span> :name <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> "user" ("id", "name", "age") <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><h2 id="\u4F7F\u7528upsertexcept\u8BBE\u7F6E\u4E0D\u66F4\u65B0\u7684\u5B57\u6BB5" class="ngde">\u4F7F\u7528<span style="color: #DD6666" class="ngde">upsertExcept</span>\u8BBE\u7F6E\u4E0D\u66F4\u65B0\u7684\u5B57\u6BB5<a title="Link to heading" class="ng-doc-header-link ngde" href="/en/database/upsert-records#\u4F7F\u7528upsertexcept\u8BBE\u7F6E\u4E0D\u66F4\u65B0\u7684\u5B57\u6BB5"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde">\u7528\u4E8E\u6307\u5B9A\u5F53\u8BB0\u5F55\u5B58\u5728\u65F6\u4E0D\u9700\u8981\u66F4\u65B0\u7684\u5B57\u6BB5\u3002</p><ng-doc-tab group="Case 3" name="kotlin" icon="kotlin" class="ngde"><pre class="ngde hljs"><code class="hljs language-kotlin code-lines ngde" lang="kotlin" name="" icon="" highlightedlines="[7,8,9,10,11]"><span class="line ngde"><span class="hljs-keyword ngde">val</span> user: User = User(
</span><span class="line ngde">        id = <span class="hljs-number ngde">1</span>,
</span><span class="line ngde">        name = <span class="hljs-string ngde">"Kronos"</span>,
</span><span class="line ngde">        age = <span class="hljs-number ngde">18</span>
</span><span class="line ngde">    )
</span><span class="line ngde">
</span><span class="line highlighted ngde">user
</span><span class="line highlighted ngde">  .upsertExcept { it.id }
</span><span class="line highlighted ngde">  .on { it.id }
</span><span class="line highlighted ngde">  .execute()
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 3" name="Mysql" icon="mysql" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> \`<span class="hljs-keyword ngde">user</span>\` <span class="hljs-keyword ngde">WHERE</span> \`id\` <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> \`<span class="hljs-keyword ngde">user</span>\` <span class="hljs-keyword ngde">SET</span> \`name\` <span class="hljs-operator ngde">=</span> :name, \`age\` <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> \`id\` <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> \`<span class="hljs-keyword ngde">user</span>\` (\`id\`, \`name\`, \`age\`) <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 3" name="PostgreSQL" icon="postgres" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> "user" <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> "user" <span class="hljs-keyword ngde">SET</span> "name" <span class="hljs-operator ngde">=</span> :name, "age" <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> "user" ("id", "name", "age") <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 3" name="SQLite" icon="sqlite" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> \`<span class="hljs-keyword ngde">user</span>\` <span class="hljs-keyword ngde">WHERE</span> \`id\` <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> \`<span class="hljs-keyword ngde">user</span>\` <span class="hljs-keyword ngde">SET</span> \`name\` <span class="hljs-operator ngde">=</span> :name, \`age\` <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> \`id\` <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> \`<span class="hljs-keyword ngde">user</span>\` (\`id\`, \`name\`, \`age\`) <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 3" name="SQLServer" icon="sqlserver" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> [<span class="hljs-keyword ngde">user</span>] <span class="hljs-keyword ngde">WHERE</span> [id] <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> [<span class="hljs-keyword ngde">user</span>] <span class="hljs-keyword ngde">SET</span> [name] <span class="hljs-operator ngde">=</span> :name, [age] <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> [id] <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> [<span class="hljs-keyword ngde">user</span>] ([id], [name], [age]) <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 3" name="Oracle" icon="oracle" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> "user" <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> "user" <span class="hljs-keyword ngde">SET</span> "name" <span class="hljs-operator ngde">=</span> :name, "age" <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> "user" ("id", "name", "age") <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><h2 id="\u4F7F\u7528onconflict\u8BBE\u7F6E\u5904\u7406\u7B56\u7565\u4E3A\u51B2\u7A81\u65F6\u66F4\u65B0" class="ngde">\u4F7F\u7528<span style="color: #DD6666" class="ngde">onConflict</span>\u8BBE\u7F6E\u5904\u7406\u7B56\u7565\u4E3A\u51B2\u7A81\u65F6\u66F4\u65B0<a title="Link to heading" class="ng-doc-header-link ngde" href="/en/database/upsert-records#\u4F7F\u7528onconflict\u8BBE\u7F6E\u5904\u7406\u7B56\u7565\u4E3A\u51B2\u7A81\u65F6\u66F4\u65B0"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde">\u5F53\u4F7F\u7528<code class="ngde">upsert</code>\u65B9\u6CD5\u65F6\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528<code class="ngde">onConflict</code>\u65B9\u6CD5\u8BBE\u7F6E\u5904\u7406\u7B56\u7565\u4E3A\u51B2\u7A81\u65F6\u66F4\u65B0\uFF0C\u5373\u5F53\u8BB0\u5F55\u5B58\u5728\u65F6\uFF0C\u66F4\u65B0\u8BB0\u5F55\u3002</p><ng-doc-tab group="Case 4" name="kotlin" icon="kotlin" class="ngde"><pre class="ngde hljs"><code class="hljs language-kotlin code-lines ngde" lang="kotlin" name="" icon="" highlightedlines="[7,8,9,10,11]"><span class="line ngde"><span class="hljs-keyword ngde">val</span> user: User = User(
</span><span class="line ngde">        id = <span class="hljs-number ngde">1</span>,
</span><span class="line ngde">        name = <span class="hljs-string ngde">"Kronos"</span>,
</span><span class="line ngde">        age = <span class="hljs-number ngde">18</span>
</span><span class="line ngde">    )
</span><span class="line ngde">
</span><span class="line highlighted ngde">user
</span><span class="line highlighted ngde">  .upsert { it.name + it.age }
</span><span class="line highlighted ngde">  .onConflict()
</span><span class="line highlighted ngde">  .execute()
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 4" name="Mysql" icon="mysql" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"># \u4F7F\u7528<span class="hljs-keyword ngde">on</span> duplicate key <span class="hljs-keyword ngde">update</span> \u8BED\u6CD5
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> \`<span class="hljs-keyword ngde">user</span>\` (\`id\`, \`name\`, \`age\`) <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age) <span class="hljs-keyword ngde">ON</span> DUPLICATE KEY <span class="hljs-keyword ngde">UPDATE</span> \`name\` <span class="hljs-operator ngde">=</span> :name, \`age\` <span class="hljs-operator ngde">=</span> :age;
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 4" name="PostgreSQL" icon="postgres" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> "user" ("id", "name", "age") <span class="hljs-keyword ngde">SELECT</span> :id, :name, :age <span class="hljs-keyword ngde">WHERE</span> <span class="hljs-keyword ngde">NOT</span> <span class="hljs-keyword ngde">EXISTS</span> (<span class="hljs-keyword ngde">SELECT</span> <span class="hljs-number ngde">1</span> <span class="hljs-keyword ngde">FROM</span> "user" <span class="hljs-keyword ngde">WHERE</span> "name" <span class="hljs-operator ngde">=</span> :name <span class="hljs-keyword ngde">and</span> "age" <span class="hljs-operator ngde">=</span> :age);
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> "user" <span class="hljs-keyword ngde">SET</span> "name" <span class="hljs-operator ngde">=</span> :name, "age" <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> "name" <span class="hljs-operator ngde">=</span> :name <span class="hljs-keyword ngde">and</span> "age" <span class="hljs-operator ngde">=</span> :age;
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 4" name="SQLite" icon="sqlite" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"># \u4F7F\u7528<span class="hljs-keyword ngde">on</span> conflict \u8BED\u6CD5
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> \`<span class="hljs-keyword ngde">user</span>\` (\`id\`, \`name\`, \`age\`) <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age) <span class="hljs-keyword ngde">ON</span> CONFLICT(\`name\`, \`age\`) DO <span class="hljs-keyword ngde">UPDATE</span> <span class="hljs-keyword ngde">SET</span> \`name\` <span class="hljs-operator ngde">=</span> :name, \`age\` <span class="hljs-operator ngde">=</span> :age;
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 4" name="SQLServer" icon="sqlserver" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde">IF <span class="hljs-keyword ngde">EXISTS</span> (<span class="hljs-keyword ngde">SELECT</span> <span class="hljs-number ngde">1</span> <span class="hljs-keyword ngde">FROM</span> [<span class="hljs-keyword ngde">user</span>] <span class="hljs-keyword ngde">WHERE</span> [name] <span class="hljs-operator ngde">=</span> :name <span class="hljs-keyword ngde">and</span> [age] <span class="hljs-operator ngde">=</span> :age)
</span><span class="line ngde">  <span class="hljs-keyword ngde">BEGIN</span> 
</span><span class="line ngde">    <span class="hljs-keyword ngde">UPDATE</span> [<span class="hljs-keyword ngde">user</span>] <span class="hljs-keyword ngde">SET</span> [name] <span class="hljs-operator ngde">=</span> :name, [age] <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> [name] <span class="hljs-operator ngde">=</span> :name <span class="hljs-keyword ngde">and</span> [age] <span class="hljs-operator ngde">=</span> :age
</span><span class="line ngde">  <span class="hljs-keyword ngde">END</span>
</span><span class="line ngde"><span class="hljs-keyword ngde">ELSE</span>
</span><span class="line ngde">  <span class="hljs-keyword ngde">BEGIN</span>
</span><span class="line ngde">    <span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> [<span class="hljs-keyword ngde">user</span>] ([id], [name], [age]) <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span><span class="line ngde">  <span class="hljs-keyword ngde">END</span>
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 4" name="Oracle" icon="oracle" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">BEGIN</span>
</span><span class="line ngde">  <span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> "user" ("id", "name", "age") <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span><span class="line ngde">EXCEPTION
</span><span class="line ngde">  <span class="hljs-keyword ngde">WHEN</span> DUP_VAL_ON_INDEX <span class="hljs-keyword ngde">THEN</span>
</span><span class="line ngde">    <span class="hljs-keyword ngde">UPDATE</span> "user" <span class="hljs-keyword ngde">SET</span> "name" <span class="hljs-operator ngde">=</span> :name, "age" <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> "name" <span class="hljs-operator ngde">=</span> :name <span class="hljs-keyword ngde">and</span> "age" <span class="hljs-operator ngde">=</span> :age;
</span><span class="line ngde"><span class="hljs-keyword ngde">END</span>;
</span></code></pre></ng-doc-tab><h2 id="\u4F7F\u7528lock\u8BBE\u7F6E\u67E5\u8BE2\u65F6\u884C\u9501" class="ngde">\u4F7F\u7528<span style="color: #DD6666" class="ngde">lock</span>\u8BBE\u7F6E\u67E5\u8BE2\u65F6\u884C\u9501<a title="Link to heading" class="ng-doc-header-link ngde" href="/en/database/upsert-records#\u4F7F\u7528lock\u8BBE\u7F6E\u67E5\u8BE2\u65F6\u884C\u9501"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde"><code class="ngde">limit</code>\u65B9\u6CD5\u7528\u4E8E\u8BBE\u7F6E\u67E5\u8BE2\u65F6\u884C\u9501\uFF0C\u6B64\u65F6Kronos\u4F1A\u6839\u636E<code class="ngde">lock</code>\u65B9\u6CD5\u8BBE\u7F6E\u7684\u9501\u7C7B\u578B\u8FDB\u884C\u9501\u7684\u6DFB\u52A0\u3002</p><ng-doc-tab group="Case 18" name="kotlin" icon="kotlin" class="ngde"><pre class="ngde hljs"><code class="hljs language-kotlin code-lines ngde" lang="kotlin" name="" icon="" highlightedlines="[1,2,3]"><span class="line highlighted ngde"><span class="hljs-keyword ngde">val</span> user: User = User(
</span><span class="line highlighted ngde">        id = <span class="hljs-number ngde">1</span>,
</span><span class="line highlighted ngde">        name = <span class="hljs-string ngde">"Kronos"</span>,
</span><span class="line ngde">        age = <span class="hljs-number ngde">18</span>
</span><span class="line ngde">    )
</span><span class="line ngde">
</span><span class="line ngde">user
</span><span class="line ngde">  .upsert { it.name + it.age }
</span><span class="line ngde">  .lock()
</span><span class="line ngde">  .execute()
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 18" name="Mysql" icon="mysql" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> \`id\`, \`name\`, \`age\` <span class="hljs-keyword ngde">FROM</span> \`<span class="hljs-keyword ngde">user</span>\` <span class="hljs-keyword ngde">FOR</span> <span class="hljs-keyword ngde">UPDATE</span>
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> \`<span class="hljs-keyword ngde">user</span>\` <span class="hljs-keyword ngde">SET</span> \`name\` <span class="hljs-operator ngde">=</span> :name <span class="hljs-keyword ngde">WHERE</span> \`id\` <span class="hljs-operator ngde">=</span> :id;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> \`<span class="hljs-keyword ngde">user</span>\` (\`id\`, \`name\`, \`age\`) <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 18" name="PostgreSQL" icon="postgres" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> "id", "name", "age" <span class="hljs-keyword ngde">FROM</span> "user" <span class="hljs-keyword ngde">FOR</span> <span class="hljs-keyword ngde">UPDATE</span>
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> "user" <span class="hljs-keyword ngde">SET</span> "id" <span class="hljs-operator ngde">=</span> :id, "name" <span class="hljs-operator ngde">=</span> :name, "age" <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> "name" <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> "user" ("id", "name", "age") <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 18" name="SQLite" icon="sqlite" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"># \u4E0D\u652F\u6301\u5BF9Sqlite\u6DFB\u52A0\u884C\u9501\u529F\u80FD\u56E0\u4E3ASqlite\u672C\u8EAB\u6CA1\u6709\u884C\u9501\u529F\u80FD
</span><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> <span class="hljs-built_in ngde">COUNT</span>(<span class="hljs-number ngde">1</span>) <span class="hljs-keyword ngde">FROM</span> "user" <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> "name" <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> "user" <span class="hljs-keyword ngde">SET</span> "id" <span class="hljs-operator ngde">=</span> :id, "name" <span class="hljs-operator ngde">=</span> :name, "age" <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> "name" <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> "user" ("id", "name", "age") <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 18" name="SQLServer" icon="sqlserver" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> [id], [name], [age] <span class="hljs-keyword ngde">FROM</span> [<span class="hljs-keyword ngde">user</span>] <span class="hljs-keyword ngde">OFFSET</span> <span class="hljs-number ngde">0</span> <span class="hljs-keyword ngde">ROWS</span> <span class="hljs-keyword ngde">FETCH</span> NEXT <span class="hljs-number ngde">10</span> <span class="hljs-keyword ngde">ROWS</span> <span class="hljs-keyword ngde">ONLY</span> ROWLOCK
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> [<span class="hljs-keyword ngde">user</span>] <span class="hljs-keyword ngde">SET</span> [id] <span class="hljs-operator ngde">=</span> :id, [name] <span class="hljs-operator ngde">=</span> :name, [age] <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> [id] <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> [name] <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> [<span class="hljs-keyword ngde">user</span>] ([id], [name], [age]) <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 18" name="Oracle" icon="oracle" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> "id", "name", "age" <span class="hljs-keyword ngde">FROM</span> "user" <span class="hljs-keyword ngde">FOR</span> <span class="hljs-keyword ngde">UPDATE</span>(NOWAIT)
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u5B58\u5728\uFF0C\u5219\u66F4\u65B0
</span><span class="line ngde"><span class="hljs-keyword ngde">UPDATE</span> "user" <span class="hljs-keyword ngde">SET</span> "id" <span class="hljs-operator ngde">=</span> :id, "name" <span class="hljs-operator ngde">=</span> :name, "age" <span class="hljs-operator ngde">=</span> :age <span class="hljs-keyword ngde">WHERE</span> "id" <span class="hljs-operator ngde">=</span> :id <span class="hljs-keyword ngde">and</span> "name" <span class="hljs-operator ngde">=</span> :name;
</span><span class="line ngde"># \u82E5\u8BB0\u5F55\u4E0D\u5B58\u5728\uFF0C\u5219\u63D2\u5165
</span><span class="line ngde"><span class="hljs-keyword ngde">INSERT</span> <span class="hljs-keyword ngde">INTO</span> "user" ("id", "name", "age") <span class="hljs-keyword ngde">VALUES</span> (:id, :name, :age);
</span></code></pre></ng-doc-tab><h2 id="\u5F71\u54CD\u884C\u6570" class="ngde">\u5F71\u54CD\u884C\u6570<a title="Link to heading" class="ng-doc-header-link ngde" href="/en/database/upsert-records#\u5F71\u54CD\u884C\u6570"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde">\u5728Kronos\u4E2D\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528<code class="ngde">upsert</code>\u65B9\u6CD5\u7684<code class="ngde">execute</code>\u65B9\u6CD5\u83B7\u53D6\u5F71\u54CD\u884C\u6570\u3002</p><pre class="ngde hljs"><code class="hljs language-kotlin code-lines ngde" lang="kotlin" name="demo" icon="kotlin" highlightedlines="[7,8,9,10,11]"><span class="line ngde"><span class="hljs-keyword ngde">val</span> user: User = User(
</span><span class="line ngde">        id = <span class="hljs-number ngde">1</span>,
</span><span class="line ngde">        name = <span class="hljs-string ngde">"Kronos"</span>,
</span><span class="line ngde">        age = <span class="hljs-number ngde">18</span>
</span><span class="line ngde">    )
</span><span class="line ngde">    
</span><span class="line highlighted ngde"><span class="hljs-keyword ngde">val</span> (affectedRows) = user
</span><span class="line highlighted ngde">                .upsert()
</span><span class="line highlighted ngde">                .on { it.id }
</span><span class="line highlighted ngde">                .execute()
</span></code></pre><h2 id="\u6279\u91CF\u66F4\u65B0\u6216\u63D2\u5165\u8BB0\u5F55" class="ngde">\u6279\u91CF\u66F4\u65B0\u6216\u63D2\u5165\u8BB0\u5F55<a title="Link to heading" class="ng-doc-header-link ngde" href="/en/database/upsert-records#\u6279\u91CF\u66F4\u65B0\u6216\u63D2\u5165\u8BB0\u5F55"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde">\u5728Kronos\u4E2D\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528<code class="ngde">Iterable&#x3C;KPojo>.upsert().execute()</code>\u6216<code class="ngde">Array&#x3C;KPojo>.upsert().execute()</code>\u65B9\u6CD5\u6279\u91CF\u66F4\u65B0\u6216\u63D2\u5165\u8BB0\u5F55\u3002</p><pre class="ngde hljs"><code class="hljs language-kotlin code-lines ngde" lang="kotlin" name="demo" icon="kotlin" highlightedlines="[14,15,16,17]"><span class="line ngde"><span class="hljs-keyword ngde">val</span> users: List&#x3C;User> = listOf(
</span><span class="line ngde">    User(
</span><span class="line ngde">        id = <span class="hljs-number ngde">1</span>,
</span><span class="line ngde">        name = <span class="hljs-string ngde">"Kronos"</span>,
</span><span class="line ngde">        age = <span class="hljs-number ngde">18</span>
</span><span class="line ngde">    ),
</span><span class="line ngde">    User(
</span><span class="line ngde">        id = <span class="hljs-number ngde">2</span>,
</span><span class="line ngde">        name = <span class="hljs-string ngde">"Kronos ORM"</span>,
</span><span class="line ngde">        age = <span class="hljs-number ngde">18</span>
</span><span class="line ngde">    )
</span><span class="line ngde">)
</span><span class="line ngde">
</span><span class="line highlighted ngde">users
</span><span class="line highlighted ngde">  .upsert { it.name + it.age }
</span><span class="line highlighted ngde">  .on { it.id }
</span><span class="line highlighted ngde">  .execute()
</span></code></pre><h2 id="\u6307\u5B9A\u4F7F\u7528\u7684\u6570\u636E\u6E90" class="ngde">\u6307\u5B9A\u4F7F\u7528\u7684\u6570\u636E\u6E90<a title="Link to heading" class="ng-doc-header-link ngde" href="/en/database/upsert-records#\u6307\u5B9A\u4F7F\u7528\u7684\u6570\u636E\u6E90"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde">\u5728Kronos\u4E2D\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5C06<code class="ngde">KronosDataSourceWrapper</code>\u4F20\u5165<code class="ngde">execute</code>\u65B9\u6CD5\uFF0C\u4EE5\u5B9E\u73B0\u81EA\u5B9A\u4E49\u7684\u6570\u636E\u5E93\u8FDE\u63A5\u3002</p><pre class="ngde hljs"><code class="hljs language-kotlin code-lines ngde" lang="kotlin" name="demo" icon="kotlin" highlightedlines="[9,10,11,12]"><span class="line ngde"><span class="hljs-keyword ngde">val</span> customWrapper = CustomWrapper()
</span><span class="line ngde">
</span><span class="line ngde"><span class="hljs-keyword ngde">val</span> user: User = User(
</span><span class="line ngde">        id = <span class="hljs-number ngde">1</span>,
</span><span class="line ngde">        name = <span class="hljs-string ngde">"Kronos"</span>,
</span><span class="line ngde">        age = <span class="hljs-number ngde">18</span>
</span><span class="line ngde">    )
</span><span class="line ngde">
</span><span class="line highlighted ngde">user
</span><span class="line highlighted ngde">  .upsert { it.name + it.age }
</span><span class="line highlighted ngde">  .on { it.id }
</span><span class="line highlighted ngde">  .execute(customWrapper)
</span></code></pre>`,b=(()=>{let s=class s extends l{constructor(){super(),this.routePrefix="",this.pageType="guide",this.pageContent=S,this.page=n,this.demoAssets=k}};s.\u0275fac=function(e){return new(e||s)},s.\u0275cmp=g({type:s,selectors:[["ng-doc-page-en-database-upsert-records"]],standalone:!0,features:[r([{provide:l,useExisting:s},t,n.providers??[]]),c,i],decls:1,vars:0,template:function(e,O){e&1&&o(0,"ng-doc-page")},dependencies:[h],encapsulation:2,changeDetection:0});let a=s;return a})(),R=[d(p({},(0,y.isRoute)(n.route)?n.route:{}),{path:"",component:b,title:"Update or Insert Records"})],H=R;export{b as DynamicComponent,H as default};
