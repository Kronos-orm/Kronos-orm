import{a as h}from"./chunk-ZFGADIWI.js";import{a as r}from"./chunk-HNPVF6HZ.js";import{a as d}from"./chunk-YGVJYOZD.js";import{H as O}from"./chunk-HT2ZSXJU.js";import{Pb as p,jc as t,kc as i,ra as o,xb as g}from"./chunk-W2MTHNV2.js";import{a as l,b as c,g as y}from"./chunk-ODN5LVDJ.js";var u=y(O());var w={title:"\u52A0\u9501\u673A\u5236",mdFile:"./index.md",category:h},e=w;var m=[];var C={},k=C;var E=`<h1 id="\u52A0\u9501\u673A\u5236" class="ngde">\u52A0\u9501\u673A\u5236<a title="Link to heading" class="ng-doc-header-link ngde" href="/zh-CN/advanced/some-locks#\u52A0\u9501\u673A\u5236"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h1><h2 id="\u60B2\u89C2\u9501" class="ngde">\u60B2\u89C2\u9501<a title="Link to heading" class="ng-doc-header-link ngde" href="/zh-CN/advanced/some-locks#\u60B2\u89C2\u9501"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde">Kronos\u4E3A<strong class="ngde">\u67E5\u8BE2</strong><code class="ngde">(select)</code>\u4E0E<strong class="ngde">\u66F4\u65B0\u63D2\u5165</strong><code class="ngde">(upsert)</code>\u529F\u80FD\u63D0\u4F9B\u4E86<strong class="ngde">\u60B2\u89C2\u9501</strong>(<code class="ngde">lock</code>)\u7684\u529F\u80FD\uFF0C\u5176\u9501\u7B49\u7EA7\u4E3A<strong class="ngde">\u884C\u9501</strong></p><p class="ngde"><code class="ngde">lock()</code>\u65B9\u6CD5\u53EF<strong class="ngde">\u4E0D\u63A5\u53D7\u53C2\u6570</strong>\u6216<strong class="ngde">\u63A5\u6536\u4E00\u4E2A\u53C2\u6570</strong><code class="ngde">lock</code>\uFF0C\u5176\u7C7B\u578B\u4E3A\u679A\u4E3E\u7C7B<code class="ngde">PessimisticLock</code></p><p class="ngde">\u76EE\u524D\u53EF\u9009\u62E9<strong class="ngde">\u72EC\u5360\u9501</strong><code class="ngde">PessimisticLock.X</code>\u6216<strong class="ngde">\u5171\u4EAB\u9501</strong><code class="ngde">PessimisticLock.S</code>\u4E24\u79CD\u7C7B\u578B\u7684\u9501</p><p class="ngde">\u4EE5\u4E0B\u4EC5\u4E3A<strong class="ngde">\u67E5\u8BE2</strong><code class="ngde">(select)</code>\u65F6\u4F7F\u7528\u60B2\u89C2\u9501\u7684\u7528\u6CD5\u793A\u4F8B\uFF0C\u5728<strong class="ngde">\u66F4\u65B0\u63D2\u5165</strong><code class="ngde">(upsert)</code>\u65F6\u4F7F\u7528\u65F6\u4EC5\u9700\u5C06<code class="ngde">.select()</code>\u66FF\u6362\u4E3A<code class="ngde">.upsert()</code></p><ng-doc-tab group="Case 1" name="kotlin" icon="kotlin" class="ngde"><pre class="ngde hljs"><code class="hljs language-kotlin code-lines ngde" lang="kotlin" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">val</span> listOfUser: List&#x3C;User> = User().select()
</span><span class="line ngde">                          .lock()
</span><span class="line ngde"><span class="hljs-comment ngde">//                          .lock(PessimisticLock.X)</span>
</span><span class="line ngde">                          .queryList()
</span><span class="line ngde">                          
</span><span class="line ngde"><span class="hljs-keyword ngde">val</span> listOfUser: List&#x3C;User> = User().select()
</span><span class="line ngde">                          .lock(PessimisticLock.S)
</span><span class="line ngde">                          .queryList()
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 1" name="Mysql" icon="mysql" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> \`id\`, \`name\`, \`age\` <span class="hljs-keyword ngde">FROM</span> \`<span class="hljs-keyword ngde">user</span>\` <span class="hljs-keyword ngde">FOR</span> <span class="hljs-keyword ngde">UPDATE</span>
</span><span class="line ngde">
</span><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> \`id\`, \`name\`, \`age\` <span class="hljs-keyword ngde">FROM</span> \`<span class="hljs-keyword ngde">user</span>\` LOCK <span class="hljs-keyword ngde">IN</span> SHARE MODE
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 1" name="PostgreSQL" icon="postgres" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> "id", "name", "age" <span class="hljs-keyword ngde">FROM</span> "user" <span class="hljs-keyword ngde">FOR</span> <span class="hljs-keyword ngde">UPDATE</span>
</span><span class="line ngde">
</span><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> "id", "name", "age" <span class="hljs-keyword ngde">FROM</span> "user" <span class="hljs-keyword ngde">FOR</span> SHARE
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 1" name="SQLite" icon="sqlite" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"># \u4E0D\u652F\u6301\u5BF9Sqlite\u6DFB\u52A0\u884C\u9501\u529F\u80FD\u56E0\u4E3ASqlite\u672C\u8EAB\u6CA1\u6709\u884C\u9501\u529F\u80FD
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 1" name="SQLServer" icon="sqlserver" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> [id], [name], [age] <span class="hljs-keyword ngde">FROM</span> [<span class="hljs-keyword ngde">user</span>] <span class="hljs-keyword ngde">OFFSET</span> <span class="hljs-number ngde">0</span> <span class="hljs-keyword ngde">ROWS</span> <span class="hljs-keyword ngde">FETCH</span> NEXT <span class="hljs-number ngde">10</span> <span class="hljs-keyword ngde">ROWS</span> <span class="hljs-keyword ngde">ONLY</span> ROWLOCK
</span></code></pre></ng-doc-tab><ng-doc-tab group="Case 1" name="Oracle" icon="oracle" class="ngde"><pre class="ngde hljs"><code class="hljs language-sql code-lines ngde" lang="sql" name="" icon="" highlightedlines="[]"><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> "id", "name", "age" <span class="hljs-keyword ngde">FROM</span> "user" <span class="hljs-keyword ngde">FOR</span> <span class="hljs-keyword ngde">UPDATE</span>(NOWAIT)
</span><span class="line ngde">
</span><span class="line ngde"><span class="hljs-keyword ngde">SELECT</span> "id", "name", "age" <span class="hljs-keyword ngde">FROM</span> "user" LOCK <span class="hljs-keyword ngde">IN</span> SHARE MODE
</span></code></pre></ng-doc-tab><h2 id="\u4E50\u89C2\u9501" class="ngde">\u4E50\u89C2\u9501<a title="Link to heading" class="ng-doc-header-link ngde" href="/zh-CN/advanced/some-locks#\u4E50\u89C2\u9501"><ng-doc-icon icon="link-2" size="16" class="ngde"></ng-doc-icon></a></h2><p class="ngde">Kronos\u63D0\u4F9B<strong class="ngde">\u4E50\u89C2\u9501</strong>\u529F\u80FD\uFF08\u5177\u4F53\u7684\u5F00\u542F\u4E0E\u4F7F\u7528\u65B9\u6CD5\u89C1\uFF1A<a href="/documentation/zh-CN/class-definition/table-class-definition#\u4E50\u89C2\u9501\u7B56\u7565" class="ngde">[\u4E50\u89C2\u9501\u7B56\u7565]</a>\uFF09</p><p class="ngde">\u88AB\u8BBE\u7F6E\u4E3A<strong class="ngde">\u4E50\u89C2\u9501</strong>\u7684\u5217\uFF08\u9ED8\u8BA4\u4E3A<code class="ngde">version</code>\uFF0C\u63A5\u4E0B\u6765\u5747\u4EE5\u8BE5\u5217\u4E3A\u4F8B\uFF09\u5728\u8BB0\u5F55\u65B0\u5EFA\u65F6\u4F1A\u88AB\u8BBE\u7F6E\u62100\uFF0C\u540E\u7EED\u6BCF\u6B21\u66F4\u65B0<code class="ngde">version = version + 1</code></p><p class="ngde">\u5728\u6267\u884C<strong class="ngde">\u66F4\u65B0\u63D2\u5165</strong><code class="ngde">(upsert)</code>\u64CD\u4F5C\u65F6\uFF0C\u4F1A\u5C06<code class="ngde">version</code>\u5B57\u6BB5\u6DFB\u52A0\u8FDB\u7B5B\u9009\u9879\uFF0C\u610F\u4E3A\u4EC5\u5F53Kpojo\u7684\u8BE5\u5B57\u6BB5\u4E0E\u6570\u636E\u5E93\u4E2D\u4FEE\u6539\u6B21\u6570\u4E00\u81F4\u65F6\u624D\u4F1A\u66F4\u65B0\u8BE5\u6761\u6570\u636E\uFF0C\u5426\u5219\u5219\u6267\u884C\u63D2\u5165</p>`,L=(()=>{let s=class s extends d{constructor(){super(),this.routePrefix="",this.pageType="guide",this.pageContent=E,this.page=e,this.demoAssets=k}};s.\u0275fac=function(a){return new(a||s)},s.\u0275cmp=o({type:s,selectors:[["ng-doc-page-zh-cn-advanced-some-locks"]],standalone:!0,features:[t([{provide:d,useExisting:s},m,e.providers??[]]),g,i],decls:1,vars:0,template:function(a,S){a&1&&p(0,"ng-doc-page")},dependencies:[r],encapsulation:2,changeDetection:0});let n=s;return n})(),f=[c(l({},(0,u.isRoute)(e.route)?e.route:{}),{path:"",component:L,title:"\u52A0\u9501\u673A\u5236"})],x=f;export{L as DynamicComponent,x as default};
